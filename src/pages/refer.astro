---
/* src/pages/refers.astro */
import "../styles/global_lend.css";

import MainLayout from "../layouts/MainLayout.astro";
import TwoColPromo from "../components/TwoColPromo.astro";
import CalcSlot from "../components/slots/CalcSlot.astro";
import PlainSlot from "../components/slots/PlainSlot.astro";
import TgChecker from "../components/slots/TgChecker.astro";
import Faq from "../components/mainpage/Faq.astro";
import { buildFAQJsonLd } from "../lib/seoData";

const seo = {
  title: "Партнёрская программа — рекомендуй и зарабатывай",
  description:
    "Рассказать друзьям про наши курсы и получать вознаграждение за каждого ученика — просто.",
  image: "/images/og/refers.jpg",
};

const faqItems = [
  {
    q: "Как стать партнёром?",
    a: "Заполните короткую форму заявки, получите персональную UTM-ссылку и начните рекомендовать курсы друзьям и знакомым. Лучше дополнительно написать в поддержку!",
  },
  {
    q: "Сколько я зарабатываю?",
    a: "За каждого ученика — фиксированная сумма в зависимости от количества приглашенных учеников (от 3000 ₽ до 5000 ₽). Плюс 15% от покупок самостоятельных курсов на Stepik.",
  },
  {
    q: "Когда происходит выплата?",
    a: "После 3 занятий у ученика или по итогам первого месяца обучения. Переводим на карту, ИП или самозанятому. Оплачиваем по факту, без задержек.",
  },
  {
    q: "Как отслеживать учеников и покупки?",
    a: "Через вашу UTM-ссылку. Также можно проверить статус по Telegram-нику в специальном виджете на этой странице.",
  },
  {
    q: "Что делать, если Telegram-ник не находится?",
    a: "Проверьте правильность написания (без пробелов и с @). Если не помогло — напишите нам в поддержку, всё сверим вручную.",
  },
];

const faqJsonLd = buildFAQJsonLd(faqItems);
---

<MainLayout
  title={seo.title}
  description={seo.description}
  image={seo.image}
  seoType="website"
  showBreadcrumbs={false}
  faqJsonLd={faqJsonLd}
>
  <section id="refers-intro">
    <TwoColPromo
      id="refers-intro"
      bg="var(--white)"
      textColor="var(--black)"
      title="Станьте партнёром нашей онлайн-школы"
      subtitle="Рекомендуйте курсы и получайте вознаграждение за каждого ученика"
      list={[
        "UTM-ссылка и отслеживание",
        "15% со Stepik-покупок рефералов",
        "Выплаты переводом, удобно и прозрачно",
      ]}
      showButton={true}
      button={{
        text: "Стать партнёром",
        href: "#refers-apply",
        variant: "blue",
      }}
      image={{
        src: "/images/refer.webp",
        alt: "Станьте партнёром нашей онлайн-школы",
        width: 450,
        height: 300,
      }}
    />
  </section>

  <section id="refers-calc">
    <TwoColPromo
      id="refers-calc"
      bg="var(--white)"
      textColor="var(--black)"
      title="Станьте партнёром нашей онлайн-школы"
      subtitle="Рекомендуйте курсы и получайте вознаграждение за каждого ученика"
      list={[
        "UTM-ссылка и отслеживание",
        "15% со Stepik-покупок рефералов",
        "Выплаты переводом, удобно и прозрачно",
      ]}
      showButton={true}
      button={{
        text: "Стать партнёром",
        href: "#refers-apply",
        variant: "blue",
      }}
    >
      <CalcSlot slot="right" />
    </TwoColPromo>
  </section>
  <!-- Блок 2: правый слот под форму/виджет -->
  <section id="refers-apply">
    <TwoColPromo
      id="refers-apply"
      bg="var(--blue)"
      textColor="var(--white)"
      title="Подайте заявку и получите свою UTM-ссылку"
      subtitle="Заполните короткую форму — менеджер активирует партнёрский профиль и пришлёт инструкцию"
      list={[
        "Проверка заявки в течение 1–2 дней",
        "Персональная UTM и кабинет учёта",
        "Поддержка в чате партнёров",
      ]}
      showButton={false}
      button={{ text: "Стать партнёром", href: "#apply", variant: "blue" }}
    >
      <div slot="right">
        <PlainSlot maxWidth="560px" padding="var(--space-24)">
          <form class="fake-form" id="partner-apply" onsubmit="return false;">
            <label class="fake-label">
              <span>Ваш Telegram @юзернейм</span>
              <input class="fake-input" type="text" placeholder="@username" />
            </label>
            <label class="fake-label">
              <span>Почта</span>
              <input
                class="fake-input"
                type="email"
                placeholder="you@mail.ru"
              />
            </label>
            <button
              class="btn btn--blue"
              style="width:100%; margin-top: var(--space-16);"
            >
              Отправить заявку
            </button>
          </form>
        </PlainSlot>
      </div>
    </TwoColPromo>
  </section>

  <!-- Блок 3: проверка статуса по Telegram -->
  <section id="refers-check">
    <TwoColPromo
      id="refers-check"
      bg="var(--white)"
      textColor="var(--black)"
      title="Проверьте статус и выплаты по Telegram"
      subtitle="Введите @ник — моментально покажем данные из учёта: число учеников, покупки на Stepik и к выплате."
      list={[
        "Данные подтягиваются из Google Sheets",
        "Если ник не найден — подскажем, что делать",
        "Работает и на мобильных",
      ]}
      showButton={true}
      button={{
        text: "Написать в поддержку",
        href: "https://t.me/valery_chemistry",
        variant: "blue",
      }}
    >
      <TgChecker slot="right" />
    </TwoColPromo>
  </section>
  <!-- Блок 4: FAQ (в конце страницы) -->
  <section id="faq">
    <Faq
      title="Частые вопросы о партнёрской программе"
      items={faqItems}
      singleOpen={true}
      headingId="refers-faq-title"
    />
  </section>
</MainLayout>
<style>
  /* ===== Верхний двухколоночный блок (без списка), на твоих токенах ===== */
  .refer-hero__box {
    margin-top: 50px;
    background: var(--white);
    color: var(--black);
    border-radius: var(--radius-24);
    box-shadow: var(--shadow-1);
    border: 1px solid var(--border);
    padding: var(--space-32);
    display: grid;
    grid-template-columns: 1.3fr 1fr;
    gap: var(--space-32);
    align-items: center;
  }
  .refer-hero__title {
    margin: 0 0 var(--space-16);
    font-size: var(--h1);
    line-height: 1.15;
    font-weight: 700;
  }
  .refer-hero__lead {
    margin: 0;
    font-size: var(--lead);
    line-height: 1.6;
    color: var(--black);
  }

  /* Кнопки */
  .refer-hero__actions {
    display: flex;
    gap: var(--space-12);
    flex-wrap: wrap;
    margin-top: var(--space-24);
  }

  .refer-hero__figure {
    margin: 0;
    overflow: hidden;
  }
  .refer-hero__figure img {
    display: block;
    width: 100%;
    height: auto;
    object-fit: cover;
  }

  /* Адаптив: на планшете и мобильном — в одну колонку */
  @media (max-width: 1100px) {
    .refer-hero__box {
      grid-template-columns: 1fr;
      gap: var(--space-24);
      padding: var(--space-24);
    }
    .refer-hero__title,
    .refer-hero__lead {
      text-align: center;
    }
    .refer-hero__actions {
      justify-content: center;
    }
  }

  /* мини-оформление заглушки формы внутри PlainSlot — на твоих токенах */
  .fake-form {
    display: grid;
    gap: var(--space-16);
  }
  .fake-label {
    display: grid;
    gap: 8px;
    font: 600 14px/1.2 var(--ff);
    color: var(--black);
  }
  .fake-input {
    height: 44px;
    border-radius: 12px;
    padding: 0 14px;
    font-size: 16px;
    border: 1px solid var(--border);
    background: #f9f9f9;
    outline: none;
    color: var(--black);
  }
  .fake-input:focus {
    background: #fff;
    border-color: var(--blue);
    box-shadow: 0 0 0 3px rgba(54, 110, 240, 0.15);
  }
</style>
