---
/** SiteFooter.astro — 3 → 2 → 1 колонки, мобильный порядок: Right → Center → Left */
const year = new Date().getFullYear();
import SupportFab from "./ui/SupportFab.astro";
import ScrollToTop from "./ui/ScrollToTop.astro";

interface Props {
  /** UTM source по странице для кнопки попапа */
  pageUtmSource?: string;
}
const { pageUtmSource = "main-page" } = Astro.props;
---

<footer class="contact-bottom" role="contentinfo" aria-label="Подвал сайта">
  <div
    class="contact-inner"
    style="max-width: var(--container); margin: 0 auto; padding: 0 var(--pad-desktop);"
  >
    <!-- 1) Левая (тех/юридическая) -->
    <div class="footer-left">
      <div class="footer-text-logo">Химия ЕГЭ с Валерием Филипенко</div>
      <p class="footer-desc">Подготовим к ЕГЭ по химии с нуля до бюджета.</p>

      <address class="footer-info">
        Самозанятый Филипенко Валерий Юрьевич<br />
        Почта: <a href="mailto:valeryfilip96@gmail.com"
          >valeryfilip96@gmail.com</a
        >
      </address>

      <nav class="footer-links" aria-label="Юридическая информация">
        <a href="/privacy" rel="noopener">Политика конфиденциальности</a><br />
        <a href="/agreement" rel="noopener">Обработка персональных данных</a><br
        />
        <a href="/payment" rel="noopener">Информация по оплате курсов</a><br />
        <a href="/marketing-consent" rel="noopener"
          >Соглашение о рекламной рассылке</a
        ><br />
        <a href="/sitemap.xml" rel="noopener">Карта сайта (sitemap)</a>
      </nav>

      <p class="footer-copy">{year} © Школа химии Валерия Филипенко</p>
    </div>

    <!-- 2) Центр (разделы — 5 ссылок) -->
    <nav class="footer-center" aria-label="Разделы сайта">
      <a href="/refer">Реферальная программа</a>
      <a href="/allcourses">Все курсы stepik</a>
    </nav>

    <!-- 3) Правая (кнопка + соцсети) -->
    <div class="footer-right">
      <button
        type="button"
        class="btn btn--blue footer-cta popup-btn"
        data-popup-id="lead-popup"
        data-utm-source={pageUtmSource}
        data-utm-medium="cta"
        data-utm-campaign="popup-lead"
        data-utm-content="footer"
      >
        Начать бесплатно
      </button>

      <p class="social-title">Напишите нам</p>
      <div class="social-icons" aria-label="Мессенджеры">
        <a
          href="https://t.me/valery_chemistry"
          target="_blank"
          rel="noopener noreferrer"
          ><img
            src="/images/technical/telegram.webp"
            alt="Telegram"
            width="20"
            height="20"
            loading="lazy"
          /></a
        >
        <a
          href="https://wa.me/79818364992?text=%D0%9F%D1%80%D0%B8%D0%B2%D0%B5%D1%82!%20"
          target="_blank"
          rel="noopener noreferrer"
          ><img
            src="/images/technical/whatsapp.webp"
            alt="WhatsApp"
            width="20"
            height="20"
            loading="lazy"
          /></a
        >
        <a
          href="https://vk.me/valeryfilip"
          target="_blank"
          rel="noopener noreferrer"
          ><img
            src="/images/technical/vk.webp"
            alt="VK"
            width="20"
            height="20"
          /></a
        >
      </div>

      <p class="social-title second">Подписывайтесь на наши соцсети</p>
      <div class="social-icons" aria-label="Соцсети">
        <a
          href="https://www.youtube.com/@chemistry_exam"
          target="_blank"
          rel="noopener noreferrer"
          ><img
            src="/images/technical/youtube.webp"
            alt="YouTube"
            width="20"
            height="20"
            loading="lazy"
          /></a
        >
        <a
          href="https://vk.com/chemistry_exam"
          target="_blank"
          rel="noopener noreferrer"
          ><img
            src="/images/technical/vk.webp"
            alt="VK"
            width="20"
            height="20"
            loading="lazy"
          /></a
        >
        <a
          href="https://t.me/+KznfEhtzkeNlZjIy"
          target="_blank"
          rel="noopener noreferrer"
          ><img
            src="/images/technical/telegram.webp"
            alt="Telegram"
            width="20"
            height="20"
            loading="lazy"
          /></a
        >
      </div>
    </div>

    <!-- 3.5) Доп.колонка (между центр и правой): медиа / rss / авторство -->
    <nav class="footer-extra" aria-label="Медиа и RSS">
      <a href="/media">Медиа</a>
      <a
        href="https://t.me/valery_chemistry"
        target="_blank"
        rel="noopener noreferrer">Хочу стать автором</a
      >
    </nav>
  </div>

  <!-- Кнопка «Наверх» -->
  <ScrollToTop />

  <!-- Плавающая кнопка поддержки -->
  <SupportFab
    telegramUrl="https://t.me/valery_chemistry"
    whatsappUrl="https://wa.me/79818364992?text=%D0%9F%D1%80%D0%B8%D0%B2%D0%B5%D1%82!%20"
    vkUrl="https://vk.me/valeryfilip"
    bottomOffset={108}
    rightOffset={20}
    zIndex={9999}
  />
</footer>

<style>
  .contact-bottom {
    background: #000;
    color: #fff;
    width: 100%;
    margin-top: clamp(24px, 6vw, 48px); /* отступ сверху, чтобы не прилипал */
    padding-block: clamp(24px, 5vw, 56px); /* вертикальные внутренние отступы */
  }
  .contact-inner {
    max-width: var(--container, 1300px);
    margin: 0 auto;
    padding: var(--pad-desktop, 50px);
    display: grid;
    grid-template-columns: 1.2fr 0.9fr 0.9fr 0.9fr; /* desktop: 4 колонки */
    grid-template-areas: "left center extra right";
    gap: var(--footer-gap, 64px);
    align-items: start;
    box-sizing: border-box;
  }
  .footer-left {
    grid-area: left;
  }
  .footer-center {
    grid-area: center;
  }
  .footer-extra {
    grid-area: extra;
  }
  .footer-right {
    grid-area: right;
  }

  .footer-text-logo {
    font-weight: 800;
    font-size: 22px;
    line-height: 1.2;
    margin: 0 0 8px;
  }
  .footer-desc {
    margin: 0 0 16px;
    font-size: 16px;
  }
  .footer-info {
    font-style: normal;
    font-size: 14px;
    line-height: 1.5;
    color: rgba(163, 165, 167, 0.9);
    margin: 0 0 16px;
  }
  .footer-info a {
    color: rgba(163, 165, 167, 0.9);
    text-decoration: none;
  }
  .footer-info a:hover {
    text-decoration: underline;
  }

  .footer-links a {
    color: rgba(163, 165, 167, 0.9);
    text-decoration: none;
    font-size: 14px;
    line-height: 1.5;
  }
  .footer-links a:hover {
    text-decoration: underline;
  }

  .footer-copy {
    margin: 18px 0 0;
    font-size: 14px;
    color: rgba(163, 165, 167, 0.9);
  }

  .footer-center a {
    display: block;
    color: #fff;
    text-decoration: none;
    font-size: 16px;
    margin-bottom: 10px;
  }
  .footer-center a:hover {
    text-decoration: underline;
  }
  .footer-extra a {
    display: block;
    color: #fff;
    text-decoration: none;
    font-size: 16px;
    margin-bottom: 10px;
  }
  .footer-extra a:hover {
    text-decoration: underline;
  }

  .footer-cta {
    display: inline-block;
    font-weight: 700;
    border-radius: 12px;
    padding: 12px 22px;
    margin-bottom: 16px;
  }

  .social-title {
    font-size: 16px;
    font-weight: 600;
    margin: 14px 0 8px;
  }
  .social-title.second {
    margin-top: 22px;
  }
  .social-icons {
    display: flex;
    gap: 8px;
    margin: 4px 0 8px;
  }
  .social-icons a {
    display: inline-flex;
    justify-content: center;
    align-items: center;
    width: 36px;
    height: 36px;
    border-radius: 50%;
    transition:
      background 0.25s,
      transform 0.15s var(--easing, ease);
  }
  .social-icons a:hover {
    transform: translateY(-1px);
  }
  .social-icons img {
    width: 80%;
    height: 80%;
    display: block;
    object-fit: contain;
  }

  /* ≤1100px: 2 колонки, порядок (left | right) / (center | extra) */
  @media (max-width: 1100px) {
    .contact-inner {
      padding: var(--space-24);
      grid-template-columns: 1fr 1fr;
      grid-template-areas:
        "left right"
        "center extra";
      gap: var(--space-24);
    }
  }

  /* ≤600px: 1 колонка, порядок Right → Extra → Center → Left
       + скрываем CTA, соцсети и заголовки по левому краю */
  @media (max-width: 600px) {
    .contact-inner {
      padding: var(--pad-mobile, 20px);
      grid-template-columns: 1fr;
      grid-template-areas:
        "right"
        "extra"
        "center"
        "left";
      gap: var(--space-20, 20px);
    }
    .footer-right {
      text-align: left; /* вместо center */
    }
    .footer-cta {
      display: none; /* скрыть кнопку на мобилке */
    }
    .social-icons {
      justify-content: flex-start; /* иконки по левому краю */
    }
    .social-title {
      text-align: left; /* мини-заголовки слева */
    }
    .footer-copy {
      text-align: center;
    }
  }

  /* Адаптивные стили для .contact-inner */
  @media (max-width: 1100px) {
    .contact-inner {
      max-width: 100% !important;
      padding: 0 24px !important;
    }
  }

  @media (max-width: 600px) {
    .contact-inner {
      padding: 0 var(--pad-mobile) !important;
    }
  }
</style>
